<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/bootstrap.css">
    <title>Document</title>
</head>
<body>
    <button id="enter" class="d-none">Click here</button>

    <section class="d-block border-bottom mt-2 p-2">
        <button class="btn btn-success mx-2 d-block" onclick="showAlert()">
            alert
        </button>
    </section>
    
    <section class="d-block border-bottom mt-2 p-2">
        <button class="btn btn-success mx-2 d-block" onclick="submitData()">
            Submit
        </button>
    
        <section id="list-clients" class="mx-2 d-block  mt-2"></section>
    </section>
    
    <section class="d-block border-bottom mt-2 p-2">
        <button class="btn btn-success mx-2 d-block" onclick="submitOnlineData()">
            Submit online
        </button>
    
        <section id="list-api-clients" class="mx-2 d-block  mt-2"></section>
    </section>

    <section class="d-block border-bottom mt-2 p-2">
        <button class="btn btn-success mx-2 d-block" onclick="showImages()">
            Show images
        </button>
        <section id="display_images" class="mx-2 d-block mt-2">
           
        </section>
    </section>

    <section class="d-block border-bottom mt-2 p-2">

        <button class="btn btn-success mx-2 d-block" onclick="callback()">
            test callback
        </button>


        <button class="btn btn-success mx-2 d-block mt-4" onclick="manager(alertHello)">
            alertHello
        </button>
        <button class="btn btn-success mx-2 d-block" onclick="manager(alertBye)">
            alertBye
        </button>
        <button class="btn btn-success mx-2 d-block" onclick="manager(alertHi)">
            alertHi
        </button>


        <button class="btn btn-success mx-2 d-block mt-4" onclick="fetchThen()">
            fetch 1
        </button>
        <button class="btn btn-success mx-2 d-block mt-4" onclick="fetchThen2()">
            fetch 2
        </button>
    </section>

    <script src="./js/jQuery.js"></script>
    <script src="./js/popper.js"></script>
    <script src="./js/bootstrap.js"></script>
    <script>

        //1
        function callback(){
            const fn = ` alert("hello") `;
            eval(fn);
            //fn()
            //console.log(fn)
        }

        /*function fn(){
            alert("hello")
        }*/


        //2
        function manager(callback){
            callback()
        }

        function alertHello(){
            alert("hello")
        }
        function alertBye(){
            alert("bye")
        }
        function alertHi(){
            alert("hi")
        }


        function fetchThen(){

            Promise.resolve() //=> fetch
                .then(() => {
                    let a = 0;
                    return a;
                })
                .then(
                    (a) =>{
                        console.log(a)
                        return a +1;
                    }
                )
                .then(
                    (a) =>{
                        console.log(a)
                        return a +1;
                    }
                )
                .then(
                    (a) =>{
                        console.log(a)
                        return a +1;
                    }
                );
        }

        function fetchThen2(){
            Promise.resolve()
                .then(() => {
                    //return '[ { "id": 1, "first_name": "Masoud", "last_name": "Maarefiyan" }, { "id": 2, "first_name": "Gazaleh", "last_name": "Samodi" }]';
                    //return 'asdasdasd';
                    return {name:'ali'};
                })
                .then(
                    (result) =>{
                        try {
                            return JSON.parse(result)
                        }
                        catch (e){
                            return result
                        }
                    }
                )
                .then(
                    (result) =>{
                        console.log(result)
                    }
                );
        }



        // 1 ---> 2 ---> 3 ---> 4
        // 1 resolve 2 resolve 3 reject
        // 1 resolve 2 reject
        // 1 reject


        /*function fetchThen2(){
            const p2 = new Promise((resolve, reject) => {
                resolve(1);
            });

            p2.then((value) => {
                console.log(value); // 1
                return value + 1;
            }).then((value) => {
                console.log(value, "- A synchronous value works"); // 2 - A synchronous value works
            });

            p2.then((value) => {
                console.log(value); // 1
            });
        }*/

    </script>
    <script>
        async function showImages(){
            //await 
            console.log("helloooooo")
            // with fetch we can get data from a specific url
            await fetch("https://jsonplaceholder.typicode.com/photos")
                //first step is: response class that js gaves us
                .then((response)=>{
                    let responseStatus= response.status
                    if (responseStatus == 200){
                        //tabdil mikone b js
                        return response
                    }else if(responseStatus == 404){
                        console.error('errorrrr')
                    }
                })
                // convert
                .then((response)=>{
                    try {
                        return response.json()
                    }
                    catch (e){
                        return response
                    }
                })
                .then((pictures)=>{
                    document.getElementById('display_images').innerHTML=''
                    pictures.forEach((item,index)=>{
                        if(index>10) 
                            return false
                        //console.log("item==")
                        //console.log(item)
                        let element =`  <a href="${item.hasOwnProperty('url')?item.url:'./images/download.jpg'}" title="${item.hasOwnProperty('title')?item.title:'not found'}" id="" >
                                            <img src="${item.hasOwnProperty('url')?item.url:'./images/download.jpg'}" alt="${item.hasOwnProperty('title')?item.title:'not found'}" >
                                        </a>`
                        //console.log("element==")
                        //console.log(element)
                        document.getElementById('display_images').innerHTML+=element
                       // console.log(index)
                        
                            
                        //console.log(item)

                    })
                  /*  for(i=0;i<pictures.length;i++){

                        let element =`  <a href="${url}" title="title" id="" >
                                            <img src="url" alt="title" >
                                        </a>`
                        document.getElementById('display_images').innerHTML+=element
                        if(i>10)
                            break
                    }*/
                    
                })
            //let pictures=[];
        }
        //showImages()
        
        /*function enterBtn(){
            alert("Button clicked!"); 
        }
        const button = document.getElementById("enter"); 
        button.addEventListener("click", function(){
            setTimeout(function(){
                alert("Button clicked!"); 
            },5000)
        }); */
        
    </script>
    <script>

        //==================================================================================================
        function showAlert(){
            alert("Hi")
        }
    
    
    
        //==================================================================================================
    
        // fetch / ajax
        //------
        // header    ---> client    // method : "get / post"
        // request   ---> client
        // api       ---> {header , request}
        // response  ---> result
        function submitData(){
    
            let dataGet = '[ { "id": 1, "first_name": "Masoud", "last_name": "Maarefiyan" }, { "id": 2, "first_name": "Gazaleh", "last_name": "Samodi" }]';
            try{
                const data = JSON.parse(dataGet)
    
                $("#list-clients").html('')
                if (data != null && Array.isArray(data)){
                    for (let i = 0; i <data.length ; i++) {
                        const item = data[i];
    
                        /*let firstName = "";
                        if (item.hasOwnProperty("first_name")){
                            firstName = item.first_name
                        }*/
                        let id = item.hasOwnProperty("id") ? item.id : null;
                        let firstName = item.hasOwnProperty("first_name") ? item.first_name : null;
                        let lastName = item.hasOwnProperty("last_name") ? item.last_name : null;
    
                        const element =
                            '<div class="mx-2 p-2 border shadow-sm row mt-2 ">' +
    
                            '<div class="col-6 bg-info border-bottom"> شناسه </div>' +
                            '<div class="col-6 border-bottom">'+id+'</div>' +
    
                            '<div class="col-6 bg-info border-bottom"> نام </div>' +
                            '<div class="col-6 border-bottom">'+firstName+'</div>' +
    
                            '<div class="col-6 bg-info ">  نام خانوادگی </div>' +
                            '<div class="col-6 ">'+lastName+'</div>' +
    
                            '</div>';
    
                        $("#list-clients").append(element)
                    }
                }
    
            }
            catch (e){
                console.error(e)
            }
    
        }
    
    
        //==================================================================================================
    
        // *---------------------------- simple fun
        // ----------------------------* async function (await)
        // promise(fetch) ----> step1 -> step2 -> step3 -> ...
        async function submitOnlineData(){
            await fetch('https://jsonplaceholder.typicode.com/users')
                //step 1
                .then((response) => {
                    const responseStatusCode = response.status;
                    if (responseStatusCode == 200){
                        return response.json()
                    }
                    else if (responseStatusCode == 404){
                        console.log("code 404")
                    }
                })
                //step 2
                .then((data) => {
                    $("#list-api-clients").html('')
                    if (data != null && Array.isArray(data)){
                        for (let i = 0; i <data.length ; i++) {
                            const item = data[i];
    
                            let id = item.hasOwnProperty("id") ? item.id : null;
                            let name = item.hasOwnProperty("name") ? item.name : null;
                            let email = item.hasOwnProperty("email") ? item.email : null;
    
                            const element =
                                '<div class="mx-2 p-2 border shadow-sm row mt-2 ">' +
    
                                '<div class="col-6 bg-info border-bottom"> شناسه </div>' +
                                '<div class="col-6 border-bottom">'+id+'</div>' +
    
                                '<div class="col-6 bg-info border-bottom"> نام </div>' +
                                '<div class="col-6 border-bottom">'+name+'</div>' +
    
                                '<div class="col-6 bg-info ">  ایمیل </div>' +
                                '<div class="col-6 ">'+email+'</div>' +
    
                                '</div>';
    
                            $("#list-api-clients").append(element)
                        }
                    }
                })
                // error
                .catch((error)=>{
                    console.error("api failed: " + error)
                });
        }
    
    
    
    
    
    
        /*    [
            {
                name: "mehdi"
            },
            {
                name: "mehdi"
            },
            {
                name: "mehdi"
            }
        ]*/
    
        /* $("#btn-test").click(function () {
            alert("asd")
        })*/
    
        /*for (let i = 0; i < ; i++) {
    
        }
    
        Object.keys().forEach(()=>{
    
        })*/
    
    </script>
</body> 
</html>